{% load static i18n %}
<form method="post"
x-data="{
        password: '',
        confirmPassword: '',
        passwordTouched: false,
        confirmPasswordTouched: false,
        passwordValid: true,
        confirmPasswordValid: true,
        
        validatePassword() {
            this.passwordValid = this.password.length >= 8;
            return this.passwordValid;
        },
        
        validateConfirmPassword() {
            this.confirmPasswordValid = this.confirmPassword.length >= 8 && 
                                      this.confirmPassword === this.password;
            return this.confirmPasswordValid;
        },
        
        
        validateAllFields() {
            this.passwordTouched = true;
            this.confirmPasswordTouched = true;
            
            const isPasswordValid = this.validatePassword();
            const isConfirmPasswordValid = this.validateConfirmPassword();
            
            return isPasswordValid && isConfirmPasswordValid;
        },
        
        submitWithValidation() {
            // TODO
        }
    }"
class="w-full min-h-[620px] h-fit  flex flex-col gap-4">
    <h6 class="title text-brand-deep-purple">New Password</h6> 
    <span class="text-sm text-gray-600">Please create a new password</span> 
        <!-- Password Field -->
        <div class="input-group" 
        :class="{'error': !passwordValid && passwordTouched}">
       <div class="simple-input">
           <input type="password" 
                  placeholder="Password" 
                  name="password" 
                  required
                  x-model="password"
                  @blur="passwordTouched = true; validatePassword()"
                  @input="if(passwordTouched) validatePassword()"/>
           <i class="fa-light fa-lock"></i>
           <span class="error-icon fa-solid fa-circle-exclamation"></span>
       </div>
       <p class="error-msg">Password must be at least 8 characters</p>
   </div>

   <!-- Confirm Password Field -->
   <div class="input-group" 
        :class="{'error': !confirmPasswordValid && confirmPasswordTouched}">
       <div class="simple-input">
           <input type="password" 
                  placeholder="Confirm Password" 
                  name="confirm-password" 
                  required
                  x-model="confirmPassword"
                  @blur="confirmPasswordTouched = true; validateConfirmPassword()"
                  @input="if(confirmPasswordTouched) validateConfirmPassword()"/>
           <i class="fa-light fa-lock"></i>
           <span class="error-icon fa-solid fa-circle-exclamation"></span>
       </div>
       <p class="error-msg">Passwords must match and be at least 8 characters</p>
   </div>
    <div class="flex justify-between items-center"> 
        <div></div>
        <button class="button button-md primary-dark" type="submit" @click.prevent>
            <span class="relative z-20">Update</span>
        </button>
    </div> 

    <div class="text-sm text-gray-400 text-center mt-auto border-t-gray-200 border-t-2 pt-4 ">
        Don't have an account?
        <a href="#" class="text-brand-indigo font-medium" @click="submitWithValidation()"
        @submit.prevent="submitWithValidation()">Signup</a>
    </div>
</form>